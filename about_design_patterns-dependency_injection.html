<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>    About design patterns: Dependency Injection
 | Antoine Veuiller</title>

        <meta name="author" content="Antoine Veuiller">
        <meta name="generator" content="Pelican v4.6.0">

        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.3/css/bootstrap.min.css" integrity="sha512-oc9+XSs1H243/FRN9Rw62Fn8EtxjEYWHXRvjS43YtueEewbS6ObfXcJNyohjHqVKFPoXXUxwc+q1K7Dee6vv9g==" crossorigin="anonymous">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css" integrity="sha512-+4zCK9k+qNFUR5X+cKL9EIR+ZOhtIloNl9GIKS57V1MyNsYpYcUrUeQc9vNfzsWfV28IaLL3i96P9sdNyeRssA==" crossorigin="anonymous">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/magnific-popup.js/1.1.0/magnific-popup.min.css" integrity="sha512-+EoPw+Fiwh6eSeRK7zwIKG2MA8i3rV/DGa3tdttQGgWyatG/SkncT53KHQaS5Jh9MNOT3dmFL0FjTY08And/Cw==" crossorigin="anonymous">

            <link rel="stylesheet" href="https://aveuiller.github.io/theme/css/main.min.css?c73fffa6">

    <script async src="https://www.googletagmanager.com/gtag/js?id=G-F9565WT2VE"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-F9565WT2VE');
    </script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.3/js/bootstrap.bundle.min.js" integrity="sha512-iceXjjbmB2rwoX93Ka6HAHP+B76IY1z0o3h+N1PeDtRSsyeetU3/0QKJqGyPJcX63zysNehggFwMC/bi7dvMig==" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/magnific-popup.js/1.1.0/jquery.magnific-popup.min.js" integrity="sha512-IsNh5E3eYy3tr/JiX2Yx4vsCujtkhwl7SLqgnwLNgf04Hrt9BT9SXlLlZlWx+OK4ndzAoALhsMNcCmkggjZB1w==" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/fitvids/1.2.0/jquery.fitvids.min.js" integrity="sha512-/2sZKAsHDmHNoevKR/xsUKe+Bpf692q4tHNQs9VWWz0ujJ9JBM67iFYbIEdfDV9I2BaodgT5MIg/FTUmUv3oyQ==" crossorigin="anonymous"></script>

            <script src="https://aveuiller.github.io/theme/js/main.min.js?86e1c044"></script>


        <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
        <link rel="manifest" href="/site.webmanifest">
        <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
        <meta name="msapplication-TileColor" content="#ffc40d">
        <meta name="theme-color" content="#ffffff">

        <!-- Feeds -->
            <link href="https://aveuiller.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Antoine Veuiller - All posts - Atom Feed">
            <link href="https://aveuiller.github.io/feeds/software-engineering.atom.xml" type="application/atom+xml" rel="alternate" title="Antoine Veuiller - Category: Software Engineering - Atom Feed">

        <meta name="keywords" content="Design Patterns, Dependency Injection, Best Practice">

    </head>

    <body class="bg-transparent pt-4">

        <div class="container">

                <a href="https://aveuiller.github.io" class="avatar-container float-left mx-4">
                    <div class="avatar ">
                        <div class="side"><img src="/images/profile.jpg" class="img-fluid"></div>
                    </div>
                </a>

            <h1>
                <a href="https://aveuiller.github.io" class="text-dark text-decoration-none">Antoine Veuiller</a>
                <small class="text-secondary"><small></small></small>
            </h1>

            <nav class="navbar d-block navbar-expand-lg navbar-light bg-light shadow rounded-lg">

                <a class="navbar-brand d-none" href="https://aveuiller.github.io" title="">Antoine Veuiller</a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#plumage-navbar-collapse-1" aria-controls="plumage-navbar-collapse-1" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <div class="collapse navbar-collapse" id="plumage-navbar-collapse-1">

                    <ul class="navbar-nav mr-auto mt-2 mt-lg-0">
<li class="nav-item ">
                                    <a class="nav-link" href="https://aveuiller.github.io/pages/about-me.html">
                                        About Me
                                    </a>
                                </li>
<li class="nav-item ">
                                    <a class="nav-link" href="https://aveuiller.github.io/category/software-engineering.html">
                                        Software Engineering
<span class="sr-only">(current)</span>                                    </a>
                                </li>
                    </ul>


                </div>

            </nav>

        </div>


        <div class="container mt-5">


            <div class="row">
                <div class="
                        col-md-9
">
    <h1>
        <a href="https://aveuiller.github.io/about_design_patterns-dependency_injection.html" rel="bookmark" title="Permalink to About design patterns: Dependency Injection">About design patterns: Dependency Injection</a>
    </h1>
                </div>
            </div>

            <div class="row">


                <div id="content" role="main" class="
                        col-md-9
">
    

    <h3>Availability Disclaimer</h3>
<p>This article can be found on other sources:</p>
<ul>
<li>Medium: <a href="https://medium.com/@aveuiller/about-design-patterns-dependency-injection-ab9c1742d4aa">Canonical link</a></li>
</ul>
<hr>
<p><img alt="credit photo: Bamboo Complexity, taufuuu" src="https://cdn-images-1.medium.com/max/800/1*1WZ618ZBnWNaYy8-XzsX0g.jpeg" class="img-fluid border rounded shadow"></p>
<h3>What is dependency injection?</h3>
<p><em>Dependency injection</em> (DI) is a very simple concept that aims to decouple components of your software and ease their integration and testing. It does so by asking for their sub-components instead of creating them.</p>
<p>During this article, we will also mention <em>inversion of control</em> (IoC), which is commonly used along with dependency injection. This pattern aims to avoid asking for implementations but rather interfaces while injecting dependencies.</p>
<p>This article will use a simple example in Java to present dependency injection but aims towards a technology-agnostic explanation of the concept and its advantages. Moreover, even if it is an object-oriented design pattern, you can still adapt the behaviour in many programming languages.</p>
<h3>Let’s clarify all this using an example!</h3>
<p>We will present a weather service that shows an intelligible representation of the weather. In the current implementation, we rely solely on a thermometer.</p>
<h4>Let’s start without dependency injection.</h4>
<p><img alt="Weather service without IoC" src="https://raw.githubusercontent.com/aveuiller/design-tutorials/master/dependencyinjection/specs/classes_without_ioc.svg" class="img-fluid border rounded shadow"></p>
<p>As you can see on the diagram, the <em>WeatherService</em> is relying on a <em>Thermometer</em>, which can be configured with a <em>TemperatureUnit</em>. 
Not using dependency injection will result in a code creating a new instance of <em>Thermometer</em> in the service, and a <em>Thermometer</em> configuring the <em>TemperatureUnit</em> to use:</p>
<p></p><div class="highlight pygments-style-emacs rounded shadow-sm mb-3" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 1</span><span style="color: #008000; font-weight: bold">public</span> <span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">Thermometer</span> {
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 2</span>  <span style="color: #008000; font-weight: bold">private</span> <span style="color: #008000; font-weight: bold">final</span> TemperatureUnit unit;
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 3</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 4</span>  <span style="color: #008000; font-weight: bold">public</span> <span style="color: #0000FF">Thermometer</span>() {
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 5</span>    <span style="color: #008000; font-weight: bold">this</span>.<span style="color: #7D9029">unit</span> <span style="color: #666666">=</span> TemperatureUnit.<span style="color: #7D9029">CELSIUS</span>;
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 6</span>  }
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 7</span>}
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 8</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 9</span><span style="color: #008000; font-weight: bold">public</span> <span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">WeatherService</span> <span style="color: #008000; font-weight: bold">implements</span> WeatherContract {
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">10</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">11</span>  <span style="color: #008000; font-weight: bold">private</span> <span style="color: #008000; font-weight: bold">final</span> Thermometer thermometer;
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">12</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">13</span>  <span style="color: #408080; font-style: italic">// This constructor is not using dependency injection</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">14</span>  <span style="color: #008000; font-weight: bold">public</span> <span style="color: #0000FF">WeatherService</span>() {
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">15</span>    <span style="color: #008000; font-weight: bold">this</span>.<span style="color: #7D9029">thermometer</span> <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> Thermometer();
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">16</span>  }
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">17</span>}
</code></pre></div>
Now let’s imagine that we want to use a <em>Thermometer</em> configured to use Fahrenheit degrees instead of Celsius. For this, we add a parameter to switch between both units.
<div class="highlight pygments-style-emacs rounded shadow-sm mb-3" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">1</span><span style="color: #008000; font-weight: bold">public</span> <span style="color: #0000FF">Thermometer</span>(<span style="color: #B00040">boolean</span> useCelsius) {
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">2</span>  <span style="color: #008000; font-weight: bold">if</span> (useCelsius) {
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">3</span>    <span style="color: #008000; font-weight: bold">this</span>.<span style="color: #7D9029">unit</span> <span style="color: #666666">=</span> TemperatureUnit.<span style="color: #7D9029">CELSIUS</span>;
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">4</span>  } <span style="color: #008000; font-weight: bold">else</span> {
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">5</span>    <span style="color: #008000; font-weight: bold">this</span>.<span style="color: #7D9029">unit</span> <span style="color: #666666">=</span> TemperatureUnit.<span style="color: #7D9029">FAHRENHEIT</span>;
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">6</span>  }
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">7</span>}
</code></pre></div>
<p>One can also argue that the user of our program won’t always have access to an actual thermometer on their device, thus you may want to be able to fall back to another implementation in this case. 
For instance, an API sending the current temperature in your area. Integrating multiple implementations inside the service could be done as shown below.</p>
<div class="highlight pygments-style-emacs rounded shadow-sm mb-3" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">1</span><span style="color: #008000; font-weight: bold">public</span> <span style="color: #0000FF">WeatherService</span>(<span style="color: #B00040">boolean</span> useRealDevice, 
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">2</span>                      <span style="color: #B00040">boolean</span> useCelsius,
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">3</span>                      String apiKey) {
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">4</span>  <span style="color: #008000; font-weight: bold">if</span> (useRealDevice) {
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">5</span>    <span style="color: #008000; font-weight: bold">this</span>.<span style="color: #7D9029">thermometer</span> <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> Thermometer(useCelsius);
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">6</span>  } <span style="color: #008000; font-weight: bold">else</span> {
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">7</span>    <span style="color: #008000; font-weight: bold">this</span>.<span style="color: #7D9029">thermometer</span> <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> ThermometerWebService(useCelsius, apiKey);
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">8</span>  }
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">9</span>}
</code></pre></div>
<p>As a result, initializing the service can be done as follows:</p>
<div class="highlight pygments-style-emacs rounded shadow-sm mb-3" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">1</span><span style="color: #008000; font-weight: bold">public</span> <span style="color: #008000; font-weight: bold">static</span> <span style="color: #B00040">void</span> <span style="color: #0000FF">main</span>(String<span style="color: #666666">[]</span> args) {
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">2</span>  <span style="color: #408080; font-style: italic">// Not using dependency injection</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">3</span>  WeatherContract weather <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> WeatherService(<span style="color: #008000; font-weight: bold">true</span>, <span style="color: #008000; font-weight: bold">true</span>, <span style="color: #008000; font-weight: bold">null</span>);
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">4</span>}
</code></pre></div>
<p>Even if it is easy to use, our current version of the <em>WeatherService</em> is not evolutive. If we take a closer look at its constructor, we can see multiple design flaws that will haunt us in the long run:</p>
<ul>
<li>The constructor is choosing its <em>Thermometer</em>. Adding a new type of Thermometer would require some parameter tricks to guess the implementation to use.</li>
<li>The constructor is managing the <em>Thermometer</em> constructor parameters. Adding the <em>ThermometerWebService</em> forced us to add a new <em>apiKey</em> parameter to it, even if unrelated to the <em>WeatherService</em>.</li>
</ul>
<p>As a result, any change to any <em>Thermometer</em> implementation may require changes on the <em>WeatherService</em> constructors. This behaviour is unwanted and breaks the <em>Separation of Concerns</em> principle.</p>
<h4>Will dependency injection improve my project?</h4>
<p>Dependency injection, associated with inversion of control, is a good way to cover this use case. It allows you to choose which kind of thermometer you want in your program depending on the situation. The following diagram gives a quick overview of our new architecture:</p>
<p><img alt="Weather service using IoC" src="https://raw.githubusercontent.com/aveuiller/design-tutorials/master/dependencyinjection/specs/classes_using_ioc.svg" class="img-fluid border rounded shadow"></p>
<p>The <strong>inversion of control</strong> is represented in this diagram by the fact that our <em>WeatherService</em> implementation is linked to <em>ThermometerContract</em> rather than any of its implementations. That’s nothing more than this.</p>
<p>As for <strong>dependency injection</strong>, <em>WeatherService</em> will now take a <em>ThermometerContract</em> in its constructor, requiring the block using the service to build an instance filling this contract:</p>
<div class="highlight pygments-style-emacs rounded shadow-sm mb-3" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">1</span><span style="color: #008000; font-weight: bold">public</span> <span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">WeatherService</span> <span style="color: #008000; font-weight: bold">implements</span> WeatherContract {
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">2</span>  <span style="color: #408080; font-style: italic">// We now use the Interface   </span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">3</span>  <span style="color: #008000; font-weight: bold">private</span> <span style="color: #008000; font-weight: bold">final</span> ThermometerContract thermometer;
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">4</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">5</span>  <span style="color: #408080; font-style: italic">// New constructor using dependency injection    </span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">6</span>  <span style="color: #008000; font-weight: bold">public</span> <span style="color: #0000FF">WeatherService</span>(ThermometerContract thermometer) {
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">7</span>    <span style="color: #008000; font-weight: bold">this</span>.<span style="color: #7D9029">thermometer</span> <span style="color: #666666">=</span> thermometer;
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">8</span>  }
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">9</span>}
</code></pre></div>
<p>As a result, the initialization of a <em>WeatherService</em> for both constructors will look like the following:</p>
<div class="highlight pygments-style-emacs rounded shadow-sm mb-3" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">1</span><span style="color: #008000; font-weight: bold">public</span> <span style="color: #008000; font-weight: bold">static</span> <span style="color: #B00040">void</span> <span style="color: #0000FF">main</span>(String<span style="color: #666666">[]</span> args) {
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">2</span>  <span style="color: #408080; font-style: italic">// Using dependency injection</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">3</span>  TemperatureUnit celsius <span style="color: #666666">=</span> TemperatureUnit.<span style="color: #7D9029">CELSIUS</span>;
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">4</span>  ThermometerContract thermometer <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> Thermometer(celsius);
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">5</span>  WeatherContract weather <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> WeatherService(thermometer);
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">6</span>}
</code></pre></div>
<p>Now, our <em>ThermometerContract</em> can be fully configured by an external part of the software. More important so, the <em>WeatherService</em> doesn’t need to know any of the available implementations of <em>ThermometerContract</em>, thus decoupling your software packages.</p>
<p>This could seem like nothing important, but this simple switch of responsibility is critical leverage for multiple aspects of software design. It enables you to control the instance creation from your software entry point by chaining dependencies. You won’t have to take care of the instantiation until it is necessary. This behaviour could be compared to raised exceptions, that are ignored until taken care of in a significant context.</p>
<h3>That’s all there is to dependency injection?</h3>
<p>It is important to know that even if you can find libraries that help you manage your dependency injection, it is not always necessary to use them.</p>
<p>Those libraries tend to cover a lot of cases thus be offputting to developers not comfortable with the pattern in the first place. In reality, they simply ease the instantiation of complex dependency trees and are not required at all.</p>
<p>The following section is an example of injecting our service using <a href="https://github.com/google/guice/wiki">Guice</a>, a dependency injection framework for Java made by Google. The concept is to reference bindings of every component you can inject in your program, so that the library can generate a class of any type, automatically.</p>
<p>Let’s consider that we have two implementations with the following constructors:</p>
<div class="highlight pygments-style-emacs rounded shadow-sm mb-3" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 1</span><span style="color: #008000; font-weight: bold">public</span> <span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">WeatherService</span> <span style="color: #008000; font-weight: bold">implements</span> WeatherContract {
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 2</span>  <span style="color: #008000; font-weight: bold">private</span> <span style="color: #008000; font-weight: bold">final</span> ThermometerContract thermometer;
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 3</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 4</span>  <span style="color: #AA22FF">@Inject</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 5</span>  <span style="color: #008000; font-weight: bold">public</span> <span style="color: #0000FF">WeatherService</span>(ThermometerContract thermometer) {
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 6</span>    <span style="color: #008000; font-weight: bold">this</span>.<span style="color: #7D9029">thermometer</span> <span style="color: #666666">=</span> thermometer;
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 7</span>  }
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 8</span>}
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 9</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">10</span><span style="color: #008000; font-weight: bold">public</span> <span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">Thermometer</span> <span style="color: #008000; font-weight: bold">implements</span> ThermometerContract {
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">11</span>  <span style="color: #008000; font-weight: bold">private</span> <span style="color: #008000; font-weight: bold">final</span> TemperatureUnit unit;
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">12</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">13</span>  <span style="color: #AA22FF">@Inject</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">14</span>  <span style="color: #008000; font-weight: bold">public</span> <span style="color: #0000FF">Thermometer</span>(<span style="color: #AA22FF">@Named</span>(WeatherModule.<span style="color: #7D9029">TEMPERATURE_UNIT</span>) 
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">15</span>                     TemperatureUnit unit) {
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">16</span>    <span style="color: #008000; font-weight: bold">this</span>.<span style="color: #7D9029">unit</span> <span style="color: #666666">=</span> unit;
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">17</span>  }
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">18</span>}
</code></pre></div>
<p>The <em>injection module</em> should be configured to bind all needed interfaces to a given implementation.
It should also be able to inject any object without a specific interface, such as the enumerate <em>TemperatureUnit</em>. 
The injection will then be bound to a specific name, “<em>temp_unit”</em> in this case.</p>
<div class="highlight pygments-style-emacs rounded shadow-sm mb-3" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 1</span><span style="color: #008000; font-weight: bold">public</span> <span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">WeatherModule</span> <span style="color: #008000; font-weight: bold">extends</span> AbstractModule {
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 2</span>  <span style="color: #008000; font-weight: bold">public</span> <span style="color: #008000; font-weight: bold">static</span> <span style="color: #008000; font-weight: bold">final</span> String TEMPERATURE_UNIT <span style="color: #666666">=</span> <span style="color: #BA2121">"temp_unit"</span>;
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 3</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 4</span>  <span style="color: #AA22FF">@Override</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 5</span>  <span style="color: #008000; font-weight: bold">protected</span> <span style="color: #B00040">void</span> <span style="color: #0000FF">configure</span>() {
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 6</span>    <span style="color: #408080; font-style: italic">// Named input configuration bindings</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 7</span>    bind(TemperatureUnit.<span style="color: #7D9029">class</span>)
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 8</span>      .<span style="color: #7D9029">annotatedWith</span>(Names.<span style="color: #7D9029">named</span>(TEMPERATURE_UNIT))
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 9</span>      .<span style="color: #7D9029">toInstance</span>(TemperatureUnit.<span style="color: #7D9029">CELSIUS</span>);
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">10</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">11</span>    <span style="color: #408080; font-style: italic">// Interface - Implementation bindings</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">12</span>    bind(ThermometerContract.<span style="color: #7D9029">class</span>).<span style="color: #7D9029">to</span>(Thermometer.<span style="color: #7D9029">class</span>);
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">13</span>    bind(WeatherContract.<span style="color: #7D9029">class</span>).<span style="color: #7D9029">to</span>(WeatherService.<span style="color: #7D9029">class</span>);
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">14</span>  }
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">15</span>}
</code></pre></div>
<p>Ultimately, the module can be used as follow, here instantiating a <em>WeatherContract</em>.</p>
<div class="highlight pygments-style-emacs rounded shadow-sm mb-3" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">1</span><span style="color: #008000; font-weight: bold">public</span> <span style="color: #008000; font-weight: bold">static</span> <span style="color: #B00040">void</span> <span style="color: #0000FF">main</span>(String<span style="color: #666666">[]</span> args) {
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">2</span>  <span style="color: #408080; font-style: italic">// Creating the injection module configured above.</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">3</span>  Injector injector <span style="color: #666666">=</span> Guice.<span style="color: #7D9029">createInjector</span>(<span style="color: #008000; font-weight: bold">new</span> WeatherModule());
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">4</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">5</span>  <span style="color: #408080; font-style: italic">// We ask for the injection of a WeatherContract, </span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">6</span>  <span style="color: #408080; font-style: italic">// which will create an instance of ThermometerContract</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">7</span>  <span style="color: #408080; font-style: italic">// with the named TemperatureUnit under the hood.</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">8</span>  WeatherContract weather <span style="color: #666666">=</span> injector.<span style="color: #7D9029">getInstance</span>(WeatherContract.<span style="color: #7D9029">class</span>);
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">9</span>}
</code></pre></div>
<p>Such modules usually provide a good power of customization to the injected elements, thus we can consider configuring the injection depending on the available implementations.</p>
<p>As a result, using a library is not required when integrating dependency injection. However, this could save a lot of time and cumbersome code in big projects.</p>
<h3>Show me some tests!</h3>
<p>As a side effect of decoupling your code, the dependency injection pattern is a real asset to improve unit testability of each component. This section contains an example of unit tests for our <em>WeatherService</em>.</p>
<p>As said above, making <em>WeatherService</em> asking for a <em>ThermometerContract</em> enables us to use any implementation we want. Hence, we can send a <em>mock</em> in the constructor, then control its behaviour from the outside.</p>
<div class="highlight pygments-style-emacs rounded shadow-sm mb-3" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 1</span><span style="color: #008000; font-weight: bold">public</span> <span style="color: #B00040">void</span> <span style="color: #0000FF">testTemperatureStatus</span>() {
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 2</span>  ThermometerContract thermometer <span style="color: #666666">=</span> Mockito.<span style="color: #7D9029">mock</span>(ThermometerContract.<span style="color: #7D9029">class</span>);
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 3</span>  Mockito.<span style="color: #7D9029">doReturn</span>(TemperatureUnit.<span style="color: #7D9029">CELSIUS</span>).<span style="color: #7D9029">when</span>(thermometer).<span style="color: #7D9029">getUnit</span>();
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 4</span>  WeatherContract weather <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> WeatherService(thermometer);
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 5</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 6</span>  Mockito.<span style="color: #7D9029">doReturn</span>(<span style="color: #666666">-50</span>f).<span style="color: #7D9029">when</span>(thermometer).<span style="color: #7D9029">getTemperature</span>();
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 7</span>  assertEquals(
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 8</span>    TemperatureStatus.<span style="color: #7D9029">COLD</span>,
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 9</span>    weather.<span style="color: #7D9029">getTemperatureStatus</span>()
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">10</span>  );
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">11</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">12</span>  Mockito.<span style="color: #7D9029">doReturn</span>(<span style="color: #666666">10</span>f).<span style="color: #7D9029">when</span>(thermometer).<span style="color: #7D9029">getTemperature</span>();
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">13</span>  assertEquals(
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">14</span>    TemperatureStatus.<span style="color: #7D9029">MODERATE</span>,
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">15</span>    weather.<span style="color: #7D9029">getTemperatureStatus</span>()
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">16</span>  );
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">17</span>}
</code></pre></div>
<p>As you can see, we can then control our thermometer without a struggle from outside our tested class.</p>
<h3>Conclusion</h3>
<p><em>Dependency injection</em> is a way of thinking your code architecture and can be simple to implement by yourself. In bigger projects, integrating a dependency injection framework can save you a lot of time in the long run.</p>
<p><em>Dependency injection</em> provides multiple non-negligible advantages such as:</p>
<ul>
<li><em>Code decoupling</em>: use the contracts and ignore implementation specificities.</li>
<li><em>Enhanced testability</em>: Unit tests almost become a pleasure to write.</li>
<li><em>Configurability</em>: you can more easily swap injected instances.</li>
</ul>
<p><a href="https://github.com/aveuiller/design-tutorials">You can find the full code example in my design tutorials repository on GitHub</a></p>



                </div>

                    <div class="col-md-3">
    <div class="card bg-light text-dark">
        <ul class="list-group list-group-flush">

            <li class="list-group-item">
                <abbr title="2020-01-05T00:00:00+01:00"><i class="fas fa-calendar"></i> Sun 05 January 2020</abbr>
            </li>

                <li class="list-group-item">
                    <address>
                        <i class="fas fa-user"></i> By
                            <a href="https://aveuiller.github.io/author/antoine-veuiller.html" rel="author">Antoine Veuiller</a>
                    </address>
                </li>

                <li class="list-group-item">
                                <a href="https://aveuiller.github.io/category/software-engineering.html" rel="tag" data-toggle="tooltip" class="badge badge-info" title="4 articles in this category">Software Engineering</a>
                            <a href="/tag/best-practice.html" data-toggle="tooltip" class="badge badge-secondary" title="2 articles with this tag">Best Practice</a>
                            <a href="/tag/dependency-injection.html" data-toggle="tooltip" class="badge badge-secondary" title="1 article with this tag">Dependency Injection</a>
                            <a href="/tag/design-patterns.html" data-toggle="tooltip" class="badge badge-secondary" title="1 article with this tag">Design Patterns</a>
                </li>



        </ul>
    </div>
                        
                    </div>

            </div>

        </div>

        <footer class="container-fluid mt-5 p-4 small">
            <div class="row mx-5">

                    <div class="col-md-2">
                            <h6>Social</h6>
                            <ul class="list-unstyled">
                                        <li><a href="http://twitter.com/AVeuiller">
        <i class="fab fa-twitter fa-fw"></i>
    Twitter
</a></li>
                                        <li><a href="https://stackoverflow.com/users/2564085/aveuiller">
        <i class="fab fa-stack-overflow fa-fw"></i>
    StackOverflow
</a></li>
                                        <li><a href="http://github.com/aveuiller">
        <i class="fab fa-github fa-fw"></i>
    GitHub
</a></li>
                                        <li><a href="https://aveuiller.medium.com/">
        <img src="https://www.google.com/s2/favicons?domain=aveuiller.medium.com" width="16" height="16" class="link-icon" alt="aveuiller.medium.com icon">
    Medium
</a></li>
                                        <li><a href="https://dev.to/aveuiller/">
        <img src="https://www.google.com/s2/favicons?domain=dev.to" width="16" height="16" class="link-icon" alt="dev.to icon">
    Dev.to
</a></li>
                            </ul>
                    </div>
                    <div class="col-md-2">
                    </div>

                <div class="col-md-2">
                    <h6>Browse content by</h6>
                    <ul class="list-unstyled">
                    </ul>
                </div>

                <div class="col-md-2 text-muted">
                    <h6>Copyright notice</h6>
                    <p class="small">
                        © Copyright
                        2020-2021
                        Antoine Veuiller.
                    </p>
                </div>

                <div class="col-md-2 text-muted">
                    <h6>Disclaimer</h6>
                    <p class="small">
                            All opinions expressed in this site are my own
                            personal opinions and are not endorsed by, nor
                            do they represent the opinions of my previous,
                            current and future employers or any of its
                            affiliates, partners or customers.
                    </p>
                </div>

                <div class="col-md-2">
                        <h6>Feeds</h6>
                        <ul class="list-unstyled small">
                                <li>
                                    <a href="https://aveuiller.github.io/feeds/all.atom.xml">
                                        <i class="fas fa-atom fa-fw"></i> All posts (Atom)
                                    </a>
                                </li>
                                <li>
                                    <a href="https://aveuiller.github.io/feeds/software-engineering.atom.xml">
                                        <i class="fas fa-atom fa-fw"></i> Category: Software Engineering (Atom)
                                    </a>
                                </li>
                        </ul>
                </div>

            </div>
            <div class="row mt-3">

                <div class="offset-3 col-6 small text-muted text-center">
                    Site generated by <a class="text-dark" href="https://getpelican.com">Pelican</a>.<br>
                    <a class="text-dark" href="https://github.com/kdeldycke/plumage">Plumage</a>
                    theme by <a class="text-dark" href="https://kevin.deldycke.com">Kevin Deldycke</a>.
                </div>

                <div class="col-3 text-right d-flex flex-column">
                    <a class="mt-auto" href="#"><i class="fas fa-arrow-up"></i> Back to top</a>
                </div>

            </div>
        </footer>

    </body>
</html>